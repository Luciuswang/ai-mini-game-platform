<template>
  <div class="home">
    <!-- åŠ¨æ€èƒŒæ™¯ -->
    <div class="background-animation">
      <div
        v-for="(shape, index) in floatingShapes"
        :key="index"
        class="floating-shape"
        :style="shape.style"
      ></div>
    </div>

    <!-- ä¸»æ ‡é¢˜åŒºåŸŸ -->
    <section class="hero">
      <div class="container">
        <h1 class="hero-title">AI å°æ¸¸æˆå¹³å°</h1>
        <p class="hero-subtitle">
          æ¢ç´¢ç”± AI åŠ©åŠ›åˆ›é€ çš„ç²¾å½©æ¸¸æˆä¸–ç•Œï¼Œæ¯ä¸€ä¸ªæ¸¸æˆéƒ½æ‰¿è½½ç€åˆ›æ„ä¸æŠ€æœ¯çš„å®Œç¾èåˆã€‚
          åœ¨è¿™é‡Œï¼Œç»å…¸æ¸¸æˆç„•å‘æ–°ç”Ÿï¼Œåˆ›æ–°ç©æ³•å±‚å‡ºä¸ç©·ã€‚
        </p>
        
        <div class="stats">
          <div class="stat-item fade-in" :class="{ visible: isVisible }">
            <span class="stat-number">{{ animatedGameCount }}</span>
            <div class="stat-label">ç²¾å“æ¸¸æˆ</div>
          </div>
          <div class="stat-item fade-in" :class="{ visible: isVisible }">
            <span class="stat-number">âˆ</span>
            <div class="stat-label">åˆ›æ„æ— é™</div>
          </div>
          <div class="stat-item fade-in" :class="{ visible: isVisible }">
            <span class="stat-number">100%</span>
            <div class="stat-label">å…è´¹ç•…ç©</div>
          </div>
        </div>
      </div>
    </section>

    <!-- æ¸¸æˆå±•ç¤ºåŒºåŸŸ -->
    <section class="games-section">
      <div class="container">
        <h2 class="section-title">ğŸ® æ¸¸æˆå¤§å…</h2>
        
        <div class="games-grid">
          <GameCard
            v-for="game in games"
            :key="game.id"
            :game="game"
            @play="handlePlayGame"
            class="fade-in"
            :class="{ visible: isVisible }"
          />
        </div>

        <div class="view-all-games">
          <router-link to="/games" class="btn btn-primary">
            <i class="fas fa-gamepad"></i>
            æŸ¥çœ‹å…¨éƒ¨æ¸¸æˆ
          </router-link>
        </div>
      </div>
    </section>

    <!-- ç‰¹è‰²åŠŸèƒ½åŒºåŸŸ -->
    <section class="features-section">
      <div class="container">
        <h2 class="section-title">âœ¨ å¹³å°ç‰¹è‰²</h2>
        
        <div class="features-grid">
          <div class="feature-item fade-in" :class="{ visible: isVisible }">
            <i class="fas fa-brain feature-icon"></i>
            <h3 class="feature-title">AI åŠ©åŠ›å¼€å‘</h3>
            <p class="feature-text">
              åˆ©ç”¨äººå·¥æ™ºèƒ½æŠ€æœ¯è¾…åŠ©æ¸¸æˆå¼€å‘ï¼Œè®©åˆ›æ„å¿«é€Ÿè½¬åŒ–ä¸ºç°å®ï¼Œ
              é™ä½å¼€å‘é—¨æ§›ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚
            </p>
          </div>

          <div class="feature-item fade-in" :class="{ visible: isVisible }">
            <i class="fas fa-mobile-alt feature-icon"></i>
            <h3 class="feature-title">è·¨å¹³å°å…¼å®¹</h3>
            <p class="feature-text">
              æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯ï¼Œå“åº”å¼è®¾è®¡ç¡®ä¿åœ¨ä»»ä½•è®¾å¤‡ä¸Š
              éƒ½èƒ½è·å¾—æœ€ä½³çš„æ¸¸æˆä½“éªŒã€‚
            </p>
          </div>

          <div class="feature-item fade-in" :class="{ visible: isVisible }">
            <i class="fas fa-palette feature-icon"></i>
            <h3 class="feature-title">ç°ä»£åŒ–è®¾è®¡</h3>
            <p class="feature-text">
              é‡‡ç”¨ç°ä»£åŒ–çš„UIè®¾è®¡ç†å¿µï¼Œéœ“è™¹ç¯æ•ˆæœã€åŠ¨æ€èƒŒæ™¯
              å’Œæµç•…åŠ¨ç”»ï¼Œå¸¦æ¥æ²‰æµ¸å¼çš„è§†è§‰ä½“éªŒã€‚
            </p>
          </div>

          <div class="feature-item fade-in" :class="{ visible: isVisible }">
            <i class="fas fa-code feature-icon"></i>
            <h3 class="feature-title">å¼€æºå…±äº«</h3>
            <p class="feature-text">
              æ‰€æœ‰æ¸¸æˆä»£ç å¼€æºå…±äº«ï¼Œæ¬¢è¿å¼€å‘è€…è´¡çŒ®åˆ›æ„ï¼Œ
              å…±åŒæ„å»ºæ›´ä¸°å¯Œçš„æ¸¸æˆç”Ÿæ€ã€‚
            </p>
          </div>
        </div>
      </div>
    </section>
  </div>
</template>

<script>
import { ref, computed, onMounted, onUnmounted } from 'vue'
import { useGameStore } from '../stores/gameStore'
import GameCard from '../components/GameCard.vue'

export default {
  name: 'Home',
  components: {
    GameCard
  },
  setup() {
    const gameStore = useGameStore()
    const isVisible = ref(false)
    const animatedGameCount = ref(0)
    const floatingShapes = ref([])

    // è®¡ç®—å±æ€§
    const games = computed(() => gameStore.games.slice(0, 4)) // åªæ˜¾ç¤ºå‰4ä¸ªæ¸¸æˆ

    // åˆ›å»ºæµ®åŠ¨å›¾å½¢
    const createFloatingShapes = () => {
      const shapes = []
      for (let i = 0; i < 6; i++) {
        const size = Math.random() * 100 + 50
        shapes.push({
          style: {
            width: `${size}px`,
            height: `${size}px`,
            left: `${Math.random() * 100}%`,
            top: `${Math.random() * 100}%`,
            animationDelay: `${Math.random() * 6}s`,
            animationDuration: `${Math.random() * 4 + 4}s`
          }
        })
      }
      floatingShapes.value = shapes
    }

    // æ•°å­—åŠ¨ç”»
    const animateGameCount = () => {
      const target = gameStore.totalGames
      const duration = 2000
      const startTime = Date.now()
      
      const animate = () => {
        const now = Date.now()
        const progress = Math.min((now - startTime) / duration, 1)
        animatedGameCount.value = Math.floor(progress * target)
        
        if (progress < 1) {
          requestAnimationFrame(animate)
        }
      }
      
      animate()
    }

    // æ»šåŠ¨ç›‘å¬
    const handleScroll = () => {
      const elements = document.querySelectorAll('.fade-in')
      elements.forEach(element => {
        const elementTop = element.getBoundingClientRect().top
        const elementVisible = 150
        
        if (elementTop < window.innerHeight - elementVisible) {
          element.classList.add('visible')
        }
      })
    }

    // å¤„ç†æ¸¸æˆç‚¹å‡»
    const handlePlayGame = (game) => {
      // åœ¨æ–°çª—å£æ‰“å¼€æ¸¸æˆ
      window.open(game.path, '_blank')
      
      // æ˜¾ç¤ºé€šçŸ¥
      if (window.showNotification) {
        window.showNotification(`æ­£åœ¨å¯åŠ¨ ${game.name}`, 'info', 3000)
      }
    }

    onMounted(() => {
      createFloatingShapes()
      
      // å»¶è¿Ÿæ˜¾ç¤ºåŠ¨ç”»
      setTimeout(() => {
        isVisible.value = true
        animateGameCount()
      }, 500)

      // æ»šåŠ¨ç›‘å¬
      window.addEventListener('scroll', handleScroll)
      handleScroll() // åˆå§‹æ£€æŸ¥
    })

    onUnmounted(() => {
      window.removeEventListener('scroll', handleScroll)
    })

    return {
      games,
      isVisible,
      animatedGameCount,
      floatingShapes,
      handlePlayGame
    }
  }
}
</script>

<style scoped>
.home {
  position: relative;
  overflow-x: hidden;
}

.background-animation {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  overflow: hidden;
  pointer-events: none;
}

.floating-shape {
  position: absolute;
  background: linear-gradient(45deg, rgba(78, 205, 196, 0.1), rgba(255, 107, 107, 0.1));
  border-radius: 50%;
  animation: float 6s ease-in-out infinite;
}

.hero {
  padding: 120px 0 80px;
  text-align: center;
  position: relative;
}

.hero-title {
  font-family: var(--font-display);
  font-size: 4rem;
  margin-bottom: 20px;
  background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color), var(--success-color));
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: glow 3s ease-in-out infinite alternate;
}

.hero-subtitle {
  font-size: 1.5rem;
  margin-bottom: 40px;
  color: var(--text-secondary);
  max-width: 800px;
  margin-left: auto;
  margin-right: auto;
  line-height: 1.6;
}

.stats {
  display: flex;
  justify-content: center;
  gap: 50px;
  margin-top: 50px;
}

.stat-item {
  text-align: center;
  padding: 20px;
  border-radius: 15px;
  background: var(--bg-card);
  backdrop-filter: blur(10px);
  border: 1px solid var(--border-color);
  transition: all 0.3s ease;
}

.stat-item:hover {
  transform: translateY(-5px);
  border-color: rgba(78, 205, 196, 0.5);
}

.stat-number {
  font-family: var(--font-display);
  font-size: 2.5rem;
  font-weight: 700;
  color: var(--primary-color);
  display: block;
}

.stat-label {
  color: var(--text-secondary);
  margin-top: 5px;
}

.games-section {
  padding: 80px 0;
}

.section-title {
  text-align: center;
  font-family: var(--font-display);
  font-size: 2.5rem;
  margin-bottom: 60px;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

.games-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 40px;
  margin-bottom: 60px;
}

.view-all-games {
  text-align: center;
  margin-top: 40px;
}

.features-section {
  padding: 80px 0;
  background: rgba(0, 0, 0, 0.3);
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 30px;
}

.feature-item {
  text-align: center;
  padding: 30px 20px;
}

.feature-icon {
  font-size: 3rem;
  color: var(--primary-color);
  margin-bottom: 20px;
}

.feature-title {
  font-size: 1.3rem;
  margin-bottom: 15px;
  color: var(--text-primary);
}

.feature-text {
  color: var(--text-secondary);
  line-height: 1.6;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .hero {
    padding: 100px 0 60px;
  }

  .hero-title {
    font-size: 2.5rem;
  }

  .hero-subtitle {
    font-size: 1.2rem;
  }

  .stats {
    flex-direction: column;
    gap: 20px;
    align-items: center;
  }

  .games-grid {
    grid-template-columns: 1fr;
    gap: 30px;
  }

  .features-grid {
    grid-template-columns: 1fr;
    gap: 30px;
  }
}
</style>
